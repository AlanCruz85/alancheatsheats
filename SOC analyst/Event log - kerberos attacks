
Source: https://app.letsdefend.io/training/lesson_detail/hunting-as-rep-roasting-attack

A SOC analyst would be looking through thousands of logs. So, to greatly reduce the noise and only look for indications of AS-REP roasting attack, analysts should use queries only to look for Event ID 4768 with the ticket encryption type of “0x17” and pre-authentication type “0”. These events should be definitely further looked into and investigated.

So to hunt for indications of AS-REP roasting accounts, analyst should look for:

1- Event ID 4768 on Domain Controller
2- Ticket Encryption Type of “0x17”
3- Pre-Authentication Type of "0"
________________________________________________________________________________________________________________________________________________

KERBEROASTING

So, to summarize, here's how you can detect kerberoasting activities from event logs:

1- Event ID 4768 with encryption type “0x17”.
2- Above event is immediately followed by Event ID 4769 also with encryption type “0x17”.
3- The account name requesting the service ticket is a domain user account and not a service account or computer account (starting with $).
4- Filter for Audit success keywords in event 4769 (Meaning the attacker got the hash).
5- In some cases, many requests for service tickets in a short period of time.

____________________________________________________________________________________________________________________________________________
