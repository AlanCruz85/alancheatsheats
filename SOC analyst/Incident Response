

Compliance (laws and rules) >>> Security policies >>> Incident response policies >>> Incident response playbook
Playbook is what will guide me day-by-day (walkthrough).

Incident response policies are related to the goals of the organization:
Confidentiality, availability and integrity. If confidentiality is more important for one company, his policies will be diferent to a company that has integrity as most important thing. 

IoC (indicator of compromise - it is a forensinc tool) will help you to evaluate the possible spread of the contamination (Containment and Erradication steps)

Containment (you need to choose which one according to the policies):
Shutdown>> Lost all memory evidence; alert the attacker; maybe jeopardise the business
Just disconnect from network, but keep running>> alert the attacker; maybe jeopardise the business
Let it run while do assessment>> the attacker can do more damage. If the server is running in a DMZ, it is easier to let it run

Maybe if confidentiality is most important >> shutdown or disconnect; and availability is most important >> let it run

The importance of trying to understand the malicious behaviour before containing it is to be able to see if you find the same behaviour happening in other machines (maybe the malware is already spread)
Reimaging before understanding the root of the problem can cause problems (for example, if the problem was that a specific server is running in a vulnerable version, the problem will continue there)
___________________________________________________________________________________________________________________________

Step-by-step that I saw in the Infosec course:
1- Get a memory dump, so, even if the hacker can hide his tracks later, you already have salved what happened;
2- If you have no information to start with: tasklist > file.txt && netstat -an >> file.txt && arp -a >> file.txt && sc query >> file.txt && systeminfo >> file.txt
3- You can compare them, the processes running, for example, should match;

_________________________________________________________________________________________________________________________________________________
Tools:
MRC (MAGNET RAM Capture) >>  free imaging tool designed to capture the physical memory of a suspect's computer
volatility >> memory forensics tool, to see the processes running, cmds, analise a specific file or binary ...
zeek >> to read logs (seems a little like wireshark)
Autopsy >> to analyse the data in the disk
Kape >>
Redline >>
______________________________________________________________________________________________________________________

Interesting sites to use:
https://www.virustotal.com
https://app.any.run/
https://www.talosintelligence.com/
https://www.hybrid-analysis.com/
